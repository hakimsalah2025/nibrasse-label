# ๐ ุฏููู ุงููุดุฑ ุนูู ุงูุณุญุงุจุฉ (Render)

## ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุฏููู ููุซู ุนูููุฉ ูุดุฑ ุชุทุจูู NIBRASSE ุนูู ููุตุฉ Render ุงูุณุญุงุจูุฉุ ุจูุง ูู ุฐูู ุงููุดุงูู ุงูุชู ูุงุฌููุงูุง ูุงูุญููู ุงููุทุจูุฉ.

**ุชุงุฑูุฎ ุงููุดุฑ ุงููุงุฌุญ:** 3 ุฏูุณูุจุฑ 2025  
**ุงูููุตุฉ:** Render.com  
**ุงูุญุงูุฉ:** โ ูุนูู ุจูุฌุงุญ

---

## ๐ ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ

### 1. ุงูุญุณุงุจุงุช ุงููุทููุจุฉ

- โ ุญุณุงุจ GitHub (ูุงุณุชุถุงูุฉ ุงูููุฏ)
- โ ุญุณุงุจ Render.com (ูููุดุฑ)
- โ ุญุณุงุจ Supabase (ูุงุนุฏุฉ ุงูุจูุงูุงุช)
- โ Google Gemini API Key (ููุฐูุงุก ุงูุงุตุทูุงุนู)

### 2. ุงูุชุฃูุฏ ูู ุฌุงูุฒูุฉ ุงูููุฏ

ูุจู ุงููุดุฑุ ุชุฃูุฏ ูู:
- โ ุฌููุน ุงูุชุนุฏููุงุช ูุญููุธุฉ ููุฑููุนุฉ ุนูู GitHub
- โ ููู `Dockerfile` ุตุญูุญ
- โ ููู `requirements.txt` ูุญุชูู ุนูู ุฌููุน ุงูููุชุจุงุช
- โ ูุงุนุฏุฉ ุจูุงูุงุช Supabase ุฌุงูุฒุฉ ููููุฃุฉ

---

## ๐ง ุงูุชุนุฏููุงุช ุงููุทููุจุฉ ูููุดุฑ ุงูุณุญุงุจู

### 1. ุชุนุฏูู `Dockerfile`

**ุงููุดููุฉ:** ุฎุทุฃ ูู ูุณุงุฑ ุงููุญุฏุงุช (ModuleNotFoundError)

**ุงูุญู:**
```dockerfile
# Copy the current directory contents into the container at /app
COPY . .

# Change to backend directory so imports work correctly
WORKDIR /app/backend

# Make port 8000 available to the world outside this container
ENV PORT=8000
EXPOSE $PORT

# Run app.py when the container launches
CMD uvicorn app.main:app --host 0.0.0.0 --port ${PORT:-8000}
```

**ููุงุญุธุฉ ูููุฉ:** ุชุบููุฑ `WORKDIR` ุฅูู `/app/backend` ูุญู ูุดููุฉ imports.

### 2. ุชุญุฏูุซ `requirements.txt`

**ุงููุดููุฉ:** ุญุฒูุฉ `langchain-text-splitters` ููููุฏุฉ

**ุงูุญู:** ุฅุถุงูุฉ ุงูุณุทุฑ ุงูุชุงูู:
```
langchain-text-splitters
```

**ุงูููู ุงููุงูู:**
```
fastapi
uvicorn
python-dotenv
google-generativeai
chromadb
supabase
python-multipart
requests
numpy
pydantic
pydantic-settings
rank_bm25
langchain-text-splitters
```

### 3. ุชุญุฏูุซ `.gitignore`

**ุงูุณุจุจ:** ููุน ุฑูุน ูููุงุช ุงูุจูุงูุงุช ุงููุญููุฉ

**ุงูุฅุถุงูุฉ:**
```gitignore
# ChromaDB
data/chroma_db/
backend/data/
*.pkl
```

### 4. ุฅุฒุงูุฉ ุงููููุงุช ุงููุญููุฉ ูู Git

```bash
git rm --cached backend/data/bm25_index.pkl
```

---

## ๐ ุฎุทูุงุช ุงููุดุฑ ุนูู Render

### ุงูุฎุทูุฉ 1: ุฑูุน ุงูููุฏ ุฅูู GitHub

```bash
# ุฅุถุงูุฉ ุฌููุน ุงูุชุบููุฑุงุช
git add .

# ุฅูุดุงุก commit
git commit -m "feat: Make app cloud-ready with stateless BM25 and updated docs"

# ุฑูุน ุฅูู GitHub
git push
```

### ุงูุฎุทูุฉ 2: ุฅูุดุงุก Web Service ูู Render

1. ุงูุชุญ [Render Dashboard](https://dashboard.render.com/)
2. ุงุถุบุท ุนูู **"New +"** โ **"Web Service"**
3. ุงุฑุจุท ูุณุชูุฏุน GitHub ุงูุฎุงุต ุจู
4. ุงููุฃ ุงูุชูุงุตูู:
   - **Name:** `nibrasse` (ุฃู ุฃู ุงุณู ุชุฎุชุงุฑู)
   - **Region:** ุงุฎุชุฑ ุงูุฃูุฑุจ ูู
   - **Branch:** `main`
   - **Runtime:** `Docker`
   - **Docker Command:** (ูุชู ุงูุชุดุงูู ุชููุงุฆูุงู ูู Dockerfile)

### ุงูุฎุทูุฉ 3: ุฅุนุฏุงุฏ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ (Environment Variables)

ูู ูุณู **Environment**ุ ุฃุถู ุงูููุงุชูุญ ุงูุชุงููุฉ:

```
GEMINI_API_KEY=your_gemini_api_key_here
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key_here
VITE_GEMINI_CHAT_MODEL=gemini-1.5-pro-002
VITE_GEMINI_EMBEDDING_MODEL=models/text-embedding-004
```

โ๏ธ **ููู ุฌุฏุงู:** ุชุฃูุฏ ูู ูุณุฎ ุงูููู ุงูุตุญูุญุฉ ูู ููู `.env` ุงููุญูู.

### ุงูุฎุทูุฉ 4: ุฅุทูุงู ุงููุดุฑ

1. ุงุถุบุท ุนูู **"Create Web Service"**
2. ุงูุชุธุฑ ุญุชู ููุชูู Build (ูุฏ ูุณุชุบุฑู 5-10 ุฏูุงุฆู)
3. ุฑุงูุจ ุงูู Logs ููุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

---

## โ ุงูุชุญูู ูู ูุฌุงุญ ุงููุดุฑ

### 1. ูุญุต Logs

ุงุจุญุซ ุนู ูุฐู ุงูุฑุณุงุฆู ูู Render Logs:

```
๐ Building BM25 index from database...
โ Fetched X chunks from DB. Building index...
โ BM25 index built successfully.
```

ุฅุฐุง ุธูุฑุช ูุฐู ุงูุฑุณุงุฆูุ ูุงููุธุงู ูุนูู ุจุดูู ุตุญูุญ.

### 2. ูุชุญ ุงูุชุทุจูู

- ุงูุชุญ ุงูุฑุงุจุท ุงูุฐู ุฃุนุทุงู ุฅูุงู Render (ูุซู: `https://nibrasse.onrender.com`)
- ุฌุฑุจ ุฑูุน ููู
- ุงุณุฃู ุณุคุงูุงู ูุงุฎุชุจุฑ ุงูุฅุฌุงุจุฉ

---

## โ๏ธ ุงููุดุงูู ุงูุดุงุฆุนุฉ ูุงูุญููู

### ุงููุดููุฉ 1: ุฅุฌุงุจุงุช ุถุนููุฉ ููุฑุงุฌุน ููููุฏุฉ

**ุงูุณุจุจ:**  
ุงูุจูุงูุงุช ุงููุฑููุนุฉ ูู Supabase ูุฏููุฉ (ูู ูุจู ุงูุชุนุฏููุงุช ุงูุชู ุฃุถุงูุช `filename` ูู metadata)

**ุงูุญู:**
1. ุงูุชุญ [Supabase Dashboard](https://supabase.com/dashboard)
2. ุงูุชูู ุฅูู **Table Editor**
3. ุงุญุฐู ุฌููุน ุงูุณุฌูุงุช ูู ุฌุฏูู `chunk`:
   ```sql
   DELETE FROM chunk;
   ```
4. ุงุญุฐู ุฌููุน ุงูุณุฌูุงุช ูู ุฌุฏูู `documents`:
   ```sql
   DELETE FROM documents;
   ```
5. ุงุฑูุน ุงููููุงุช **ูู ุฌุฏูุฏ** ุนุจุฑ ูุงุฌูุฉ ุงูุชุทุจูู ุนูู Render

**ููุงุญุธุฉ:** ูุฐู ุงูุฎุทูุฉ **ุถุฑูุฑูุฉ** ุจุนุฏ ูู ุชุญุฏูุซ ููููุฏ ูุคุซุฑ ุนูู metadata.

### ุงููุดููุฉ 2: ุงูุชุทุจูู ูุง ูุจุฏุฃ

**ุงูุฃุฎุทุงุก ุงููุญุชููุฉ:**
- `ModuleNotFoundError`: ุชุญูู ูู `requirements.txt` ู `Dockerfile`
- `Connection Error`: ุชุญูู ูู Environment Variables ูู Render

**ุงูุญู:**
1. ุฑุงุฌุน Logs ูู Render
2. ุชุฃูุฏ ูู ุตุญุฉ ุฌููุน ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ
3. ุฃุนุฏ Deploy:
   - ุงุฐูุจ ุฅูู **Settings** โ **Manual Deploy** โ **Deploy latest commit**

### ุงููุดููุฉ 3: ุจุทุก ูู ุงูุจุฏุก

**ุงูุณุจุจ:** ุนุงุฏูุ Render ูููู ุจุฅุนุงุฏุฉ ุจูุงุก BM25 index ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุงูุญุงูุฉ ุงูุทุจูุนูุฉ:**
- ุฃูู ุชุดุบูู: 30-60 ุซุงููุฉ (ุญุณุจ ุญุฌู ุงูุจูุงูุงุช)
- ุงูุชุดุบููุงุช ุงูุชุงููุฉ: ููุณ ุงููุฏุฉ (ุจุณุจุจ ุฅุนุงุฏุฉ ุงูุจูุงุก ูู DB)

---

## ๐ ุงูููุฒุงุช ุงููููุนูููุฉ ุจุนุฏ ุงููุดุฑ

### 1. ุงูุจุญุซ ุงููุฌูู (Hybrid Search)

- โ Vector Search (Supabase pgvector)
- โ BM25 Lexical Search (ููุนุงุฏ ุจูุงุคู ูู DB ุนูุฏ ูู ุชุดุบูู)
- โ RRF (Reciprocal Rank Fusion)

### 2. ุงููุฑุงุฌุน ุงูุฏูููุฉ

- โ ุนุฑุถ ุงุณู ุงูููู ุงูุญูููู ูู ุงููุฑุงุฌุน
- โ ุนุฑุถ ุฃุฑูุงู ุงูุตูุญุงุช (ุฅู ูุฌุฏุช)
- โ ูุซุงู: `[1] ูุชุงุจ ุงูุฐูุงุก ุงูุงุตุทูุงุนู (ุตูุญุฉ 145)`

### 3. Stateless Architecture

- โ ูุง ุชูุฌุฏ ูููุงุช ูุญููุฉ ูุทููุจุฉ
- โ ูุนูู ุนูู ุฃู ุนุฏุฏ ูู Instances
- โ ุฅุนุงุฏุฉ ุงูุชุดุบูู ูุง ุชููุฏ ุฃู ุจูุงูุงุช

---

## ๐ ุณูุฑ ุงูุนูู ููุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ

### ุนูุฏ ุชุนุฏูู ุงูููุฏ

1. ุนุฏูู ุงููููุงุช ูุญููุงู
2. ุงุฎุชุจุฑ ูุญููุงู
3. ุงุฑูุน ุฅูู GitHub:
   ```bash
   git add .
   git commit -m "ูุตู ุงูุชุนุฏูู"
   git push
   ```
4. Render ุณูููู ุชููุงุฆูุงู ุจู Auto-Deploy (ุฅุฐุง ูุงู ููุนูุงู)

### ุนูุฏ ุชุนุฏูู ุงูุจูุงูุงุช (Schema)

ุฅุฐุง ุบููุฑุช:
- ูููู ุงูู metadata
- ุทุฑููุฉ ุชุฎุฒูู ุงูุจูุงูุงุช
- ุฅุถุงูุฉ ุญููู ุฌุฏูุฏุฉ

**ูุฌุจ ุนููู:**
1. ูุณุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช (Supabase)
2. ุฅุนุงุฏุฉ ุฑูุน ุฌููุน ุงููููุงุช

---

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### Metrics ูููุฉ

1. **Startup Time:** ูุฌุจ ุฃูุง ูุชุฌุงูุฒ 60 ุซุงููุฉ
2. **Response Time:** 5-15 ุซุงููุฉ ููู ุณุคุงู
3. **Memory Usage:** ุฑุงูุจ ุงุณุชููุงู ุงูุฐุงูุฑุฉ ูู Render

### ุงููุตูู ุฅูู Logs

```
Render Dashboard โ Your Service โ Logs
```

ุงุจุญุซ ุนู:
- โ ุฃุฎุทุงุก (Errors)
- โ๏ธ ุชุญุฐูุฑุงุช (Warnings)
- โ ุฑุณุงุฆู ุงููุฌุงุญ (Success messages)

---

## ๐ฏ ุงูุฎูุงุตุฉ

### ูุง ุชู ุฅูุฌุงุฒู

1. โ ุงูุชุทุจูู ูุนูู ุนูู Render ุจูุฌุงุญ
2. โ BM25 index ููุนุงุฏ ุจูุงุคู ุชููุงุฆูุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. โ ุงููุฑุงุฌุน ุชุธูุฑ ุจุฃุณูุงุก ุงููููุงุช ุงูุตุญูุญุฉ
4. โ ูุง ุชูุฌุฏ ูููุงุช ูุญููุฉ ูุทููุจุฉ (Stateless)
5. โ ุงูุชูุซูู ูุญุฏูุซ ูููุชูู

### ุงูุฎุทูุงุช ุงูุญุงุณูุฉ ูููุฌุงุญ

1. ๐ ุชุนุฏูู `Dockerfile` (`WORKDIR /app/backend`)
2. ๐ ุฅุถุงูุฉ `langchain-text-splitters` ุฅูู `requirements.txt`
3. ๐ **ูุณุญ ูุงุนุฏุฉ ุงูุจูุงูุงุช** ูุจู ุฅุนุงุฏุฉ ุฑูุน ุงููููุงุช
4. ๐ ุงูุชุฃูุฏ ูู ุตุญุฉ Environment Variables

---

**ุชู ุงูุชูุซูู ุจูุงุณุทุฉ:** Antigravity AI  
**ุงูุชุงุฑูุฎ:** 3 ุฏูุณูุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ูุดุฑ ูุงุฌุญ ูููุฎุชุจุฑ
